## Rythmanalyse 5.1
## Nouveautés
## Visualisation touches clavier (frequence, durée moyenne, totale)
## Visualisation appui pad (frequence, durée moyenne, totale)


## A faire
## Vitesse souris et recentrage : coince toujours ...
## Améliorer prise en charge des gâchettes
## Vérifier que les exceptions linguistiques sont traitées

rm(list=ls()) # on vide la mémoire de RStudio
setwd("~/Documents/Projets R/Rythmanalyse") #choix du dossier où se trouve le script Rythma.5.1.R

# Installation (si besoin) et chargement des packages requis
packages <- c("ggplot2", "gridExtra","RColorBrewer","treemapify","dplyr")
if (length(setdiff(packages, rownames(installed.packages()))) > 0) {
  install.packages(setdiff(packages, rownames(installed.packages())))  
}
library(ggplot2)
library(gridExtra)
library (RColorBrewer)
library(treemapify)
library (dplyr)  

source("RScripts/RythmaFUNZIP5.1.R") #charge la fonction d'analyse

## ANALYSE INDIVIDUELLE
## lancer Rythmanalyse ("nomdefichier", debut = 0, fin ="max"), 
## "nomdefichier" est du type "2014.02.16.MT.Doom.s1.zip"
## debut = valeur (en minutes) où débuter l'analyse
## fin = valeur (en minutes) où achever l'analyse
## par défaut début est à 0, fin à "max"

## ex. Rythmanalyse ("2016.03.29.MT.Shardlight.s2.zip") avec valeurs par défaut
## ex. Rythmanalyse ("2016.03.24.MT.Sylvio.s1.zip", debut = 5, fin =60)

## Pour chaque fichier la fonction enregistre 
## (1) les resultats dans un .ok.csv
## (2) une analyse graphique minimale des appuis clavier et souris / pad

## POUR UN TRAITEMENT MASSE
## Placer dans le répertoire de travail les .zip

session <- list.files (path = "Data", pattern = ".zip") # Récupérer liste des fichiers .zip dans le répertoire de travail

resultats <- lapply(session, Rythmanalyse, debut = 0, fin = "max") # On applique la fonction d'analyse
resultats <- do.call("rbind",resultats) # On aggrège les résultats
write.csv(resultats, file="AddData.csv") #Choisir le nom du fichier de sortie
