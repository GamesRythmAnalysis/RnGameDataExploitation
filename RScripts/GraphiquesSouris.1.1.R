# SORTIES GRAPHIQUES
# GRAPHIQUES SOURIS

graphiques.souris <- function (d.M, M.DuM,recentre, infobaz) {
  
  d.Mc <- subset (d.M, M.EVENEMENT == "mouse 1 down" | M.EVENEMENT == "mouse 2 down")
  ggplot(data = d.Mc, aes (M.TEMPS)) +
    geom_density (kernel = "gaussian", bw = 10, 
                  linetype = 1, size = 2, color ="blue") +
    xlab ("Temps (s)") +
    ylab ("Appuis") +
    ggtitle (label = "Frequence des appuis souris",
             subtitle = infobaz) +
    theme_classic()
  ggsave(filename = paste (infobaz,".M10",".png", sep =""), width = 15, height = 7)
  
  
  d.MnoMov <- filter (d.M, M.EVENEMENT %in% c("mouse 1 down", "mouse 2 down", "mouse scroll down", "mouse scroll up"))
  
  ggplot(data = d.MnoMov, aes(M.TEMPS, fill = M.EVENEMENT)) +
    geom_area (stat="bin", binwidth = M.DuM*3, position = "stack", linetype = 1, size = 0.8, colour ="black") +
    xlab ("Temps (s)") +
    ylab ("Appuis") +
    ggtitle (label = "Frequence des click | binwidth variable",
             subtitle = infobaz) +
    scale_fill_brewer("MouseClick", palette="Set1")+
    theme_classic()
  ggsave(filename = paste (infobaz,".MF",".png", sep =""), width = 15, height = 7)


if (recentre == FALSE) { # On teste si donnees mouvement souris ne sont pas bugges
  d2sampl <- d.M[sample(nrow(d.M), (nrow(d.M)/10)), ]
    
  ggplot (d2sampl,aes (x=-M.XPOS, y=-M.YPOS)) +
      geom_point(colour ="lightblue", alpha =0.25) +
      stat_density2d(aes(alpha = ..level.., fill=..level..), bins = 15, geom = "polygon")+
      scale_alpha_continuous(guide = FALSE)+
      scale_fill_gradient(low = "green", high = "red") +
      geom_density2d (colour="black", bins = 15, alpha = 0.25) + 
      ggtitle(paste(infobaz,"\n","Mouvement Souris"))
    ggsave (file = paste (infobaz,".M.map",".png", sep =""),
            width = 150, height = 125, units = "mm")
  
} else {
  
  # la fonction de recentrage avec les graphiques
  # qui retourne le calcul de la vitesse de la souris
  # M.Vit <- recentrage (d.M,infobaz)
  # M.VitTrueXY <- FALSE 
  }
  
}

  

  