
#==#==#==#==#

# Fonction graphiques.stack : cr?e un graphique d'empilement via geom_area position = stack

# Return : le plot cr?er via ggplot

#==#==#==#==#

# graphiques.stack(timingappui2,down.time,bouton,duree * 3,
# "Frequence des appuis pad (touches frequentes) | binwidth variable",infobaz,"Touche",
# paste (infobaz, ".TCHVAR", ".png", sep = ""),
# "Temps (s)","Appuis")

# data <- timingappui2
# aes.x <- timingappui2$down.time
# aes.y <- timingappui2$bouton
# binwidth <- duree * 3
# title <- "Test"
# subtitle <- "Blablaba"
# aes.fill <- timingappui2$bouton
# save.file <- paste (infobaz, ".TCHVAR", ".png", sep = "")
# xlab <- "X"
# ylab <- "Y"

graphiques.stackfull<-function(data,aes.x,aes.fill,binwidth,title,subtitle,fill.brewer,save.file,xlab,ylab,save=TRUE,width = 15,height = 7){
  
  attach(data)
  
  plot <- ggplot(data = data, aes(aes.x, fill = aes.fill)) +
    geom_area (stat="bin", binwidth = binwidth, position = "fill", linetype = 1, size = 0.8, colour ="black") +
    xlab (xlab) +
    ylab (ylab) +
    ggtitle (label = title,subtitle = subtitle) +
    scale_fill_brewer(fill.brewer, palette="Set1")+
    theme_classic()
  
  if (save){
    ggsave(filename = save.file , width = width, height = height)
  }
  
  detach(data) 
  return(plot)
  
}