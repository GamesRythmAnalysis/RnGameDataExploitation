# SORTIES GRAPHIQUES
# GRAPHIQUES SOURIS

graphiques.souris <- function (d.M, M.DuM,recentre, infobaz) {
  
  d.Mc <- subset (d.M, M.EVENEMENT == "mouse 1 down" | M.EVENEMENT == "mouse 2 down")
  ggplot(data = d.Mc, aes (M.TEMPS)) +
    geom_density (kernel = "gaussian", bw = 10, 
                  linetype = 1, size = 2, color ="blue") +
    xlab ("Temps (s)") +
    ylab ("Appuis") +
    ggtitle (label = "Frequence des appuis souris",
             subtitle = infobaz) +
    theme_classic()
  ggsave(filename = paste (infobaz,".M10",".png", sep =""), width = 15, height = 7)
  
  
  d.MnoMov <- filter (d.M, M.EVENEMENT %in% c("mouse 1 down", "mouse 2 down", "mouse scroll down", "mouse scroll up"))
  
  ggplot(data = d.MnoMov, aes(M.TEMPS, fill = M.EVENEMENT)) +
    geom_area (stat="bin", binwidth = M.DuM*3, position = "stack", linetype = 1, size = 0.8, colour ="black") +
    xlab ("Temps (s)") +
    ylab ("Appuis") +
    ggtitle (label = "Frequence des click | binwidth variable",
             subtitle = infobaz) +
    scale_fill_brewer("MouseClick", palette="Set1")+
    theme_classic()
  ggsave(filename = paste (infobaz,".MF",".png", sep =""), width = 15, height = 7)


if (recentre == FALSE) { # On teste si donnees mouvement souris ne sont pas bugges
  d2sampl <- d.M[sample(nrow(d.M), (nrow(d.M)/10)), ]
  
  graphiques.heatmap( d2sampl,-M.XPOS,
                      -M.YPOS,
                      paste(infobaz,"\n","Mouvement Souris"),
                      paste (infobaz,".M.map",".png", sep =""))
  
} else {
  
  # la fonction de recentrage avec les graphiques
  # qui retourne le calcul de la vitesse de la souris
  # M.Vit <- recentrage (d.M,infobaz)
  # M.VitTrueXY <- FALSE 
  }
  
}

  

  