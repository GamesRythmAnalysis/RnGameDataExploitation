
#==#==#==#==#

# Fonction graphiques.polar : créer un graphique représentant les appuis en coordonnées polaires

# Return : le plot créer via ggplot

#==#==#==#==#
#graphiques.stack(
#  timingappui2,
#  down.time,
#  touche,
#  keyResult$K.DuM * 3,
#  "Frequence des appuis clavier (touches frequentes) | binwidth variable",
#  infobaz,
#  "Touche",
#  paste (infobaz, ".TCHVAR", ".png", sep = ""),
#  "Temps (s)",
#  "Appuis"
#)


# data <- timingappui2
# keyResult <- keyResult[[1]]
# keyboardRythm <- keyResult[[2]]
# touchesFreq <- keyResult[[3]]
# clavier.graphiques(data,keyResult[[1]],keyResult[[2]],keyResult[[3]],infobaz)


graphiques.partitionPAD <-function(data,titre,infobaz,save.file,save=TRUE,width = 15,height = 7){
  
  # attach(data)
  
  # ggplot(data = d.R, aes (x = down.time, y = touche, size = duration)) +
  #  geom_point()
  
  # ajouter une fake touche pour la valeur 0 au centre du cercle
  mestouches <- levels(data$bouton)
  #data <- rbind (data.frame(bouton = "ZERO", down.time = NA, durApp = NA), data)
  #data$bouton <- as.factor (data$bouton)
  #data$bouton <- factor(data$bouton, c("ZERO", mestouches))
  
  plot <- ggplot(data = data, aes (x = down.time, y = bouton, 
                               color = bouton)) +
    geom_point(aes(size = durApp^2, alpha = 0.8)) +
    # coord_polar(theta = "x", direction=1, start = 0 ) +
    scale_color_brewer(palette = "Set1", name = "",
                       breaks = mestouches) +
    scale_size(range = c(1,30)) +
    guides(size = "none", alpha = "none", color ="none")+ 
    ggtitle (label = titre, subtitle = infobaz) +
    theme_minimal () +
    ylab ("") +
    xlab ("Temps (s)") + 
    theme(plot.background = element_rect(fill = "white", color ="white"))
  
  plot
  
  if (save){
    ggsave(filename = save.file , width = width, height = height)
  }
  
#  detach(data) 
  return(plot)
  
}
