click.rythm <- function(click){
  
  clickUp<-paste(click," up",sep="")
  clickDown <-paste(click, " down",sep="")
  clickList<-subset (d.M, M.EVENEMENT == clickDown |  M.EVENEMENT == clickUp)
  
  Rez <- data.frame(down.time=numeric(),duration=numeric(),MouseClick=factor())
  down.time <-NULL
  
  if (nrow(clickList)>2) {
    
    for(i in 1:nrow(clickList)){
      #si on trouve l'evenement down on sauvegarde sont temps si il y as 2 down de suite on garde le nouveau
      if(clickList$M.EVENEMENT[i] == clickDown){
        down.time<-clickList$M.TEMPS[i]}
      
      if(clickList$M.EVENEMENT[i] == clickUp){
        
        if (is.null(down.time)){ #si il n'y as pas de down avant le up on set les variable a NA
          duration <- NA
          down.time <- NA
        } else {
          duration <- clickList$M.TEMPS[i] - down.time
        }
        #on concatene le tout et on reset down.time
        ligne <-c(down.time,duration)
        Rez <- rbind (Rez,ligne)
        down.time <-NULL
      }
    }
    
    Rez$MouseClick <- click  
  }
  
  names(Rez) <- c("down.time","duration","MouseClick")
  return(Rez)
  
}