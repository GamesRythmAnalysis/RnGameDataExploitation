
#==#==#==#==#

# Fonction click.rythm : recupere la duree des click pour un input choisi

# Return : un data frame :
# - down.time: le moment ou le l'action a commencer
# - duration: la duree de l'action
# - MouseClick: le type d'action

#==#==#==#==#

click.rythm <- function(click, data) {
  clickUp <- paste(click, " up", sep = "")
  clickDown <- paste(click, " down", sep = "")
  
  
  Rez <- data.frame(
    down.time = numeric(),
    duration = numeric(),
    MouseClick = factor()
  )
  
  down.time <- NULL
  
  for (i in 1:nrow(data)) {
    if (data[i, "M.EVENEMENT"] != clickDown &
        data[i, "M.EVENEMENT"] != clickUp)
      next
    
    #si on trouve l'evenement down on sauvegarde sont temps si il y as 2 down de suite on garde le nouveau
    if (data$M.EVENEMENT[i] == clickDown) {
      down.time <- data$M.TEMPS[i]
    }
    
    if (data$M.EVENEMENT[i] == clickUp) {
      
      if (is.null(down.time)) {
        
        #si il n'y as pas de down avant le up on set les variable a NA
        duration <- NA
        down.time <- NA
      } else {
        duration <- data$M.TEMPS[i] - down.time
      }
      
      #on concatene le tout et on reset down.time
      ligne <- c(down.time, duration)
      Rez <- rbind (Rez, ligne)
      down.time <- NULL
    }
  }
  if (nrow(Rez)) {
    Rez$MouseClick <- click
  }
  
  names(Rez) <- c("down.time", "duration", "MouseClick")
  return(Rez)
  
}