
#==#==#==#==#

# Fonction souris.cadrant : sythetise les movements de la souris en les regrooupant par portion d'arc de cercles

# Return : Un dataframe avec une colonne de factor indiquant l'appartenance a un cadrant d'une donnée.

#==#==#==#==#

souris.cadrant <- function(clickData, recentrer) {
  centred <- data;
  if (recentrer) {
    # TODO
  } else {
    # Première étape : centrer les données
    centred <- data.frame(
      M.XPOS = clickData$M.XPOS[-1] - clickData$M.XPOS[-length(clickData$M.XPOS)],
      M.YPOS = clickData$M.YPOS[-1] - clickData$M.YPOS[-length(clickData$M.YPOS)],
      M.TEMPS = clickData$M.TEMPS[-1]
    )
  }
  
  cadrans <- 8:1;
  
  # Deuxième étape : calcul des angles des points
  
  coords <- centred$M.XPOS + 1i * centred$M.YPOS;
  coords <- coords[coords != 0]
  
  coords <- Arg(coords)
  # Rotation des angles pour pouvoir grouper de manière plus naturelle. Le 8 vient directement du nombre de segment.
  coords[coords<pi/8] <- coords[coords<pi/8] + 2*pi
  
  splited_data <- factor(length(coords),levels = cadrans)
  
  # Regroupement des donnée en fonction du cadrant.
  d <- lapply(cadrans, function(c){
    splited_data[coords <= 2*pi*c/8 + pi/8] <<- c
  })
  
  return(data.frame(cadrans = splited_data));
}