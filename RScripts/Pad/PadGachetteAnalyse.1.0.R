pad.gachette.analyse <- function(gachData){

  gachResult <- data.frame(bouton = factor(),down.time=numeric() ,durApp=numeric(),vit.pression = numeric(), vit.relache = numeric())
  
  if (nrow (gachData) > 50) {
    
    # est vrai si les donnée on été prise sur windows
    win <- grepl ("Axe", gachData$P.TOUCHE) 
    
    if (win[1]) {
      gachG <- subset (gachData, gachData$P.VALEUR > 0)  
      gachG <- data.frame (gachG$P.TEMPS,gachG$P.VALEUR)
      names (gachG) <- c("P.TEMPS","P.VALEUR")
      gachD <- subset (gachData, gachData$P.VALEUR < 0)
      gachD <- data.frame (gachD$P.TEMPS,abs(gachD$P.VALEUR))
      names (gachD) <- c("P.TEMPS","P.VALEUR")
      
      # permet que les deux gachette ai la meme forme pour les analyse
      gachD$P.VALEUR <- abs(gachD$P.VALEUR)
    } else   {
      gachG <- subset (gachData, gachData$P.TOUCHE == "z")
      gachG <- data.frame (gachG$P.TEMPS,gachG$P.VALEUR)
      names (gachG) <- c("P.TEMPS","P.VALEUR")
      gachG$P.VALEUR <- (gachG$P.VALEUR+1)/2
      
      gachD <- subset (gachData, gachData$P.TOUCHE == "rz")
      gachD <- data.frame (gachD$P.TEMPS,gachD$P.VALEUR)
      names (gachD) <- c("P.TEMPS","P.VALEUR")
      gachD$P.VALEUR <- (gachD$P.VALEUR+1)/2
    }
    
    # On passe la fonction pour gachette gauche et droite 
    
    if (nrow(gachG) > 50){
      gauche<-gachette.pic.detect(gachG)
      gaucheResult <- cbind(bouton = factor("LT"),gachette.rythm(gauche))
      gachResult <- rbind(gachResult ,gaucheResult)
      
    }
    
    if (nrow(gachD) > 50){
      droite <- gachette.pic.detect(gachD)
      droiteResult <- cbind(bouton = factor("RT"),gachette.rythm(droite))
      gachResult <- rbind(gachResult , droiteResult)
      
    }  
  }
  
  return(gachResult[gachResult$vit.pression != 0,])
}