pad.gachette.analyse <- function(gachData){
  
  
  # traiter separemment linux (-1;+1) et windows (0;+1)
  # linux ou windows
  if (nrow (gachData) > 50) {
    win <- grepl ("Axe", gachData$P.TOUCHE) # si TRUE win
    
    # on normalise les donnée vers le format windows 
    if (win[1]) {
      
      gachG <- subset (gachData, gachData$P.VALEUR > 0)  
      gachG <- data.frame (gachG$P.TEMPS,gachG$P.VALEUR)
      names (gachG) <- c("P.TEMPS","P.VALEUR")
      gachD <- subset (gachData, gachData$P.VALEUR < 0)
      gachD <- data.frame (gachD$P.TEMPS,abs(gachD$P.VALEUR))
      names (gachD) <- c("P.TEMPS","P.VALEUR")
    
    } else   {
      gachG <- subset (gachData, gachData$P.TOUCHE == "z")
      gachG <- data.frame (gachG$P.TEMPS,gachG$P.VALEUR)
      names (gachG) <- c("P.TEMPS","P.VALEUR")
      gachG$P.VALEUR <- (gachG$P.VALEUR+1)/2
      gachD <- subset (gachData, gachData$P.TOUCHE == "rz")
      gachD <- data.frame (gachD$P.TEMPS,gachD$P.VALEUR)
      names (gachD) <- c("P.TEMPS","P.VALEUR")
      gachD$P.VALEUR <- (gachD$P.VALEUR+1)/2
    }
    
    # On passe la fonction pour gachette gauche et droite 
    
    if (nrow(gachG) > 50){
      gauche <- gachette.pic.detect(gachG)
      
      poshaut <- grep ("Haut", gauche$P.UPDOWN)
      P.NbApGachG <- length (poshaut)
      P.DurApGachG <- mean (gauche$P.TEMPS[poshaut+1]-gauche$P.TEMPS[poshaut-1])
      P.DurApTotGachG <- sum (gauche$P.TEMPS[poshaut+1]-gauche$P.TEMPS[poshaut-1])
      P.DurApGachGSD <- sd (gauche$P.TEMPS[poshaut+1]-gauche$P.TEMPS[poshaut-1])
      P.EntreApGacgG <- mean (gauche$P.TEMPS[poshaut[2:length (poshaut)]]-gauche$P.TEMPS[poshaut[1:(length (poshaut)-1)]])
      P.EntreApGacgGSD <- sd (gauche$P.TEMPS[poshaut[2:length (poshaut)]]-gauche$P.TEMPS[poshaut[1:(length (poshaut)-1)]])
      ligne <- data.frame (P.TOUCHE = "GachetteGauche", P.NbAppuis = P.NbApGachG,
                           P.TpMoyEntreAppuis = P.EntreApGacgG, P.TpSDEntreAppuis = P.EntreApGacgGSD,
                           P.TpMoyAppui = P.DurApGachG, P.DurAppuiTot = P.DurApTotGachG, P.TpSDAppui = P.DurApGachGSD)
      results <- rbind(results,ligne)  
      appuisG <- subset (gauche, P.UPDOWN == "Haut")
      appuisG <- data.frame (P.TOUCHE ="GachetteGauche", P.TEMPS = appuisG$P.TEMPS)
      timingAppui <- rbind (timingAppui, appuisG)
    }
    
    if (nrow(gachD) > 50){
      droite <- gachette.pic.detect(gachD)
      
      poshaut <- grep ("Haut", droite$P.UPDOWN)
      P.NbApGachD <- length (poshaut)
      P.DurApGachD <- mean (droite$P.TEMPS[poshaut+1]-droite$P.TEMPS[poshaut-1])
      P.DurApTotGachD <- sum (droite$P.TEMPS[poshaut+1]-droite$P.TEMPS[poshaut-1])
      P.DurApGachDSD <- sd (droite$P.TEMPS[poshaut+1]-droite$P.TEMPS[poshaut-1])
      P.EntreApGachD <- mean (droite$P.TEMPS[poshaut[2:length (poshaut)]]-droite$P.TEMPS[poshaut[1:(length (poshaut)-1)]])
      P.EntreApGachDSD <- sd (droite$P.TEMPS[poshaut[2:length (poshaut)]]-droite$P.TEMPS[poshaut[1:(length (poshaut)-1)]])
      ligne <- data.frame (P.TOUCHE = "GachetteDroite", P.NbAppuis = P.NbApGachD,
                           P.TpMoyEntreAppuis = P.EntreApGachD, P.TpSDEntreAppuis = P.EntreApGachDSD,
                           P.TpMoyAppui = P.DurApGachD, P.DurAppuiTot = P.DurApTotGachD, P.TpSDAppui = P.DurApGachDSD)
      results <- rbind(results,ligne)  
      appuisD <- subset (droite, P.UPDOWN == "Haut")
      appuisD <- data.frame (P.TOUCHE ="GachetteDroite", P.TEMPS = appuisD$P.TEMPS)
      timingAppui <- rbind (timingAppui, appuisD)
    }  
  }
}