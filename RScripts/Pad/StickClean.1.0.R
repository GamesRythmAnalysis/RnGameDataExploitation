# IN
# Temps | Touche | valeur
# 1     | X      | 12
# 2     | Y      | 36
# 5     | X      | 16
# 8     | X      | 8

stick.clean <- function(stickData){
  if (nrow(stickData) < 10){
    return(stickXY <- data.table (P.TEMPS=numeric(), X =numeric(), 
                                  Y = numeric()))
  }
  
  # recreer les coordonnees x/y a chaque temps
  # de une colone qui contient les chagment x et Y on cree 2 colone des valeur x et y
  condition <- grepl ("y",stickData$P.TOUCHE,ignore.case =TRUE)
  Y <- ifelse (condition,stickData$P.VALEUR,NA)
  X <- ifelse (!condition,stickData$P.VALEUR,NA)
  
  # Current data format
  # Temps | X  | Y
  # 1     | 0  | 0
  # 2     | 12 | NA
  # 5     | NA | 36
  # 8     | 16 | NA
  # NA    | 8  | NA
  # Replacing the NA with the previously known value with 0 as a default starting value
  # the system only log changes which mean that the only thing we assume is the default starting value. 
  # All of the other values are as coorect as the original data 
  
  Y <- c (0,Y)
  X <- c (0,X)
  condition <- is.na (Y)
  for (i in 2:length(Y)){
    if (condition[i]){
      Y[i] <- Y[i-1]
    } else {
      X[i] <- X[i-1]
    }
  }
  
  # Current data format
  # Temps | X  | Y
  # 1     | 0  | 0
  # 2     | 12 | 0
  # 5     | 12 | 36
  # 8     | 16 | 36
  # NA    | 8  | 36
  
  stickXY <- data.table (P.TEMPS=stickData$P.TEMPS, X = X[-1], 
                         Y = Y[-1])
  
  # on utilise unique car on as des ligne qui se duplique lors du processus (environs 1% de ligne dupliquÃ©)
  return(stickXY)
}

# OUT
# Temps | X  | Y
# 1     | 12 | 0
# 2     | 12 | 36
# 5     | 16 | 36
# 8     | 8  | 36
